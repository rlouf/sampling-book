Search.setIndex({"docnames": ["algorithms/contour_sgld", "algorithms/cyclical_sgld", "algorithms/pathfinder", "index", "models/hierarchical_bnn", "models/logistic_regression", "models/mlp", "models/sparse_regression"], "filenames": ["algorithms/contour_sgld.md", "algorithms/cyclical_sgld.md", "algorithms/pathfinder.md", "index.md", "models/hierarchical_bnn.md", "models/logistic_regression.md", "models/mlp.md", "models/sparse_regression.md"], "titles": ["Contour stochastic gradient Langevin dynamics", "Cyclical SGLD", "Pathfinder", "The Sampling Book Project", "Hierarchical Bayesian Neural Networks", "Bayesian Logistic Regression", "MLP classifier", "Sparse regression"], "terms": {"big": 0, "data": [0, 1, 7], "problem": 0, "fundament": 0, "limit": [0, 2], "multi": [0, 4], "modal": 0, "target": [0, 2, 6, 7], "distribut": [0, 1, 2, 4, 7], "extrem": 0, "high": [0, 4, 7], "energi": 0, "barrier": 0, "often": [0, 6], "empir": 0, "solv": [0, 4], "via": 0, "cyclic": [0, 3], "learn": [0, 1, 2, 4, 5, 6, 7], "rate": [0, 1, 6], "differ": [0, 1, 4, 6, 7], "initi": [0, 1, 4, 6, 7], "parallel": 0, "chain": [0, 5, 6, 7], "take": [0, 6], "approach": 0, "altogeth": 0, "algorithm": [0, 1, 2, 5, 7], "landscap": 0, "us": [0, 1, 2, 3, 4, 5, 6, 7], "thi": [0, 1, 2, 3, 4, 5, 6, 7], "approxim": [0, 1, 2, 6, 7], "effect": [0, 1, 6, 7], "integr": [0, 6], "diffus": 0, "flat": 0, "befor": [0, 6], "import": [0, 1, 2, 4, 5, 6, 7], "weight": [0, 2, 4, 5], "reweigh": 0, "obtain": 0, "In": [0, 1, 2, 4, 5, 6, 7], "notebook": [0, 2, 4, 5], "we": [0, 1, 2, 3, 4, 5, 6, 7], "compar": [0, 6], "perform": [0, 4], "simpl": [0, 1, 2, 4, 5, 6], "bimod": 0, "exampl": [0, 1, 6, 7], "look": [0, 1, 4, 6, 7], "rather": 0, "challeng": [0, 1, 7], "most": [0, 6], "method": [0, 6], "let": [0, 1, 4, 6, 7], "first": [0, 2, 5, 6, 7], "gener": [0, 1, 4, 7], "point": [0, 1, 2, 4, 5, 6, 7], "follow": [0, 1, 2, 6, 7], "The": [0, 6, 7], "appear": 0, "yet": [0, 1], "hard": [0, 1, 7], "enough": [0, 4], "fail": 0, "recov": 0, "two": [0, 1, 2, 4, 5, 7], "mode": [0, 1, 2, 7], "jax": [0, 1, 2, 4, 5, 6, 7], "numpi": [0, 1, 2, 4, 5, 6, 7], "jnp": [0, 1, 2, 4, 5, 6], "scipi": [0, 1, 6, 7], "jsp": [0, 1], "def": [0, 1, 2, 4, 5, 6, 7], "gaussian_mixture_model": 0, "mu": [0, 1, 2, 4], "5": [0, 1, 2, 4, 6, 7], "0": [0, 1, 2, 4, 5, 6, 7], "sigma": [0, 1, 2, 5, 7], "gamma": [0, 2], "20": [0, 1, 6, 7], "sample_fn": [0, 1], "rng_kei": [0, 1, 2, 4, 5, 6, 7], "num_sampl": [0, 2, 4, 5, 6, 7], "key1": 0, "key2": 0, "key3": 0, "random": [0, 1, 2, 4, 5, 6, 7], "split": [0, 1, 2, 4, 5, 6, 7], "3": [0, 1, 2, 4, 5, 6, 7], "prob_mixtur": 0, "bernoulli": [0, 2, 4, 5, 7], "p": [0, 2, 5, 6, 7], "shape": [0, 1, 2, 4, 5, 6, 7], "1": [0, 1, 2, 4, 5, 6, 7], "mixture_1": 0, "normal": [0, 1, 2, 4, 5, 6, 7], "mixture_2": 0, "return": [0, 1, 2, 4, 5, 6, 7], "logprior_fn": [0, 4, 6], "posit": [0, 1, 2, 4, 5, 7], "loglikelihood_fn": [0, 1, 4, 6], "x": [0, 1, 2, 4, 5, 6, 7], "stat": [0, 1, 6, 7], "norm": [0, 6], "logpdf": [0, 1, 6], "loc": 0, "scale": [0, 4, 7], "special": [0, 1], "logsumexp": [0, 1], "arrai": [0, 1, 2, 6, 7], "log": [0, 2, 5, 6], "data_s": [0, 6], "1000": [0, 4, 6, 7], "prngkei": [0, 1, 2, 4, 5, 6, 7], "888": 0, "sample_kei": [0, 1], "x_data": 0, "No": [0, 1, 2, 4, 5, 6], "gpu": [0, 1, 2, 4, 5, 6], "tpu": [0, 1, 2, 4, 5, 6], "found": [0, 1, 2, 4, 5, 6], "fall": [0, 1, 2, 4, 5, 6], "back": [0, 1, 2, 4, 5, 6], "cpu": [0, 1, 2, 4, 5, 6], "set": [0, 1, 2, 4, 5, 6], "tf_cpp_min_log_level": [0, 1, 2, 4, 5, 6], "rerun": [0, 1, 2, 4, 5, 6], "more": [0, 1, 2, 3, 4, 5, 6], "info": [0, 1, 2, 4, 5, 6, 7], "matplotlib": [0, 1, 2, 4, 5, 6, 7], "pylab": [0, 1, 6, 7], "plt": [0, 1, 2, 4, 5, 6, 7], "ax": [0, 1, 2, 4, 5, 6, 7], "subplot": [0, 1, 2, 4, 5], "111": [0, 1, 6], "hist": [0, 7], "squeez": [0, 4], "100": [0, 1, 2, 4, 6, 7], "set_xlabel": [0, 1, 6, 7], "set_xlim": [0, 1, 6, 7], "left": [0, 2, 5, 7], "15": [0, 1, 2, 4, 7], "right": [0, 1, 2, 5, 6, 7], "35": [0, 1, 7], "set_ytick": [0, 6], "spine": [0, 1, 2, 5, 6, 7], "top": [0, 1, 2, 5, 6, 7], "set_vis": [0, 1, 6, 7], "fals": [0, 1, 2, 5, 6, 7], "titl": [0, 1, 4, 6], "text": [0, 1, 6], "from": [0, 1, 2, 4, 5, 7], "fastprogress": [0, 1, 6], "progress_bar": [0, 1, 6], "blackjax": [0, 1, 2, 3, 4, 5, 6, 7], "sgmcmc": [0, 1, 6], "specifi": 0, "hyperparamet": 0, "total_it": 0, "10_000": [0, 1, 2], "thinning_factor": 0, "10": [0, 1, 2, 6, 7], "batch_siz": [0, 6], "lr": 0, "1e": [0, 1, 2], "temperatur": 0, "50": [0, 2, 4, 5, 7], "init_posit": [0, 1, 7], "build": [0, 1, 6, 7], "sgdl": 0, "sampler": [0, 1, 3, 6, 7], "grad_fn": [0, 1, 6], "grad_estim": [0, 6], "one": [0, 1, 4, 5, 6, 7], "step": [0, 2, 4, 5, 6, 7], "vanilla": 0, "sgld_sample_list": 0, "pb": [0, 6], "rang": [0, 1, 2, 4, 6, 7], "iter_": 0, "batch_kei": 0, "data_batch": 0, "shuffl": 0, "jit": [0, 1, 2, 5, 6], "append": [0, 1, 4, 6], "comment": [0, 6], "f": [0, 1, 2, 4, 5, 6, 7], "2f": [0, 2, 4], "00": [0, 1, 6, 7], "10000": 0, "lt": [0, 1, 6], "23": [0, 7], "opt": [0, 6], "hostedtoolcach": [0, 6], "python": [0, 6], "9": [0, 6, 7], "16": [0, 6, 7], "x64": [0, 6], "lib": [0, 6], "python3": [0, 6], "site": [0, 6], "packag": [0, 6], "_src": [0, 1, 6], "py": [0, 6], "400": [0, 2], "futurewarn": 0, "deprec": 0, "remov": 0, "futur": 0, "releas": 0, "permut": 0, "independ": [0, 4, 7], "true": [0, 1, 2, 4, 6, 7], "warn": [0, 4, 6, 7], "msg": 0, "gridspec": [0, 7], "fig": [0, 1, 2, 4, 5, 6, 7], "figur": [0, 1, 2, 4, 5, 6, 7], "figsiz": [0, 1, 2, 4, 5, 6, 7], "12": [0, 1, 4, 5, 6, 7], "6": [0, 1, 2, 4, 5, 6, 7], "g": [0, 7], "trajectori": [0, 1], "2": [0, 1, 2, 4, 5, 6, 7], "plot": [0, 1, 2, 5, 6, 7], "label": [0, 1, 4, 6], "iter": [0, 1, 2, 6], "set_ylabel": [0, 1, 2, 6, 7], "histogram": [0, 6], "suptitl": 0, "98": [0, 7], "zeta": 0, "sz": 0, "ar": [0, 1, 2, 4, 5, 6, 7], "onli": [0, 4, 6], "tune": [0, 6, 7], "paramet": [0, 2, 4, 6, 7], "partit": 0, "space": 0, "need": [0, 2, 5, 6], "num_partit": 0, "100000": 0, "energy_gap": 0, "25": [0, 1, 4, 7], "domain_radiu": 0, "restart": 0, "when": [0, 6, 7], "particl": 0, "explor": [0, 1, 7], "too": [0, 4, 6], "deep": [0, 1], "over": [0, 6], "tail": 0, "lead": [0, 1, 6], "nan": [0, 2], "logdensity_fn": [0, 2, 4, 5, 7], "logdensity_estim": 0, "csgld": 0, "can": [0, 1, 2, 5, 6, 7], "each": [0, 1, 2, 4, 5, 6, 7], "lower": [0, 1], "level": [0, 2, 4, 7], "interfac": 0, "cannot": [0, 7], "min_energi": 0, "simul": 0, "state": [0, 1, 2, 4, 5, 6, 7], "init": [0, 1, 2, 4, 5, 6], "csgld_sample_list": 0, "csgld_energy_idx_list": 0, "subkei": 0, "stepsize_sa": 0, "min": [0, 5, 7], "8": [0, 1, 2, 5, 6, 7], "energy_idx": 0, "18": [0, 4, 7], "meta": 0, "base": [0, 1, 4], "It": [0, 2, 6, 7], "inspir": 0, "wang": 0, "landau": 0, "densiti": [0, 2, 5, 6], "inform": 0, "flatten": [0, 2, 4], "so": [0, 2, 4, 5, 7], "easili": 0, "As": [0, 1, 6], "result": 0, "directli": 0, "resampl": 0, "them": [0, 4, 6, 7], "get": [0, 2, 4, 6, 7], "important_idx": 0, "where": [0, 1, 2, 5, 6], "energy_pdf": 0, "quantil": 0, "95": [0, 6, 7], "scaled_energy_pdf": 0, "max": [0, 5, 6, 7], "csgld_re_sample_list": 0, "_": [0, 1, 2, 4, 5, 6, 7], "my_idx": 0, "none": [0, 2, 4, 5, 6, 7], "samples_in_my_idx": 0, "concaten": [0, 4, 5, 6, 7], "after": 0, "legend": [0, 1, 4, 6], "crucial": 0, "s": [0, 1, 2, 4, 5, 7], "estim": [0, 1, 2, 6, 7], "For": [0, 4], "illustr": [0, 4], "purpos": 0, "smooth": 0, "out": 0, "fluctat": 0, "focu": 0, "3700": 0, "which": [0, 1, 2, 4, 5, 6], "cover": 0, "major": 0, "part": 0, "smooth_energy_pdf": 0, "convolv": 0, "pdf": 0, "arang": [0, 6], "101": 0, "same": [0, 1], "interested_idx": 0, "lax": [0, 1, 2, 4, 5, 7], "floor": 0, "astyp": 0, "int32": 0, "3681": 0, "add_subplot": [0, 1, 6, 7], "show": [0, 2, 4, 5, 6], "abov": [0, 1, 6], "see": [0, 1, 2, 4, 6], "low": 0, "region": 0, "usual": 0, "much": [0, 1], "higher": [0, 4], "probabl": [0, 2, 5, 6], "mass": [0, 2], "moreov": 0, "slope": 0, "neg": 0, "view": 0, "eq": 0, "paper": 0, "expect": 0, "help": [0, 2, 3], "escap": [0, 1], "local": [0, 2, 7], "trap": 0, "eventu": 0, "abl": 0, "bounc": 0, "freeli": 0, "instead": [0, 1, 2, 6, 7], "being": 0, "absorb": 0, "admittedli": 0, "littl": [0, 4], "sophist": 0, "due": [0, 4, 6], "also": [0, 4, 6, 7], "make": [0, 2, 6, 7], "delic": 0, "larg": [0, 1, 7], "varianc": 0, "howev": [0, 1, 6], "allow": [0, 4, 6, 7], "principl": [0, 6], "framework": [0, 7], "without": 0, "ani": [0, 7], "trick": 0, "reduc": 0, "version": [0, 4, 7], "studi": 0, "demonstr": [1, 5], "how": [1, 2], "creat": [1, 2, 4, 5, 6, 7], "non": [1, 4, 7], "trivial": 1, "implement": [1, 2, 5, 7], "zlz": 1, "19": [1, 7], "stochast": [1, 3], "gradient": [1, 3, 6], "mcmc": [1, 4], "typic": [1, 6], "sampl": [1, 2, 4, 7], "posterior": [1, 2, 4, 7], "bayesian": [1, 3, 6], "neural": [1, 3, 6], "network": [1, 3, 6], "thei": [1, 3], "other": 1, "minibatch": [1, 6], "full": 1, "dataset": [1, 2, 4, 5, 6], "ineffici": 1, "multimod": 1, "To": [1, 2, 6], "consid": [1, 4, 6, 7], "an": [1, 4, 5, 6, 7], "gaussian": [1, 4, 6], "itertool": 1, "lmbda": [1, 7], "4": [1, 2, 6, 7], "list": [1, 7], "prod": 1, "product": [1, 7], "03": [1, 7], "ey": [1, 2, 5], "logprob_fn": 1, "multivariate_norm": [1, 2, 5], "choose_kei": 1, "choic": [1, 6], "np": [1, 2, 4, 6, 7], "gaussian_kd": [1, 7], "vmap": [1, 2, 4, 6, 7], "xmin": [1, 5], "ymin": [1, 5], "xmax": [1, 5], "ymax": [1, 5], "nbin": 1, "300j": 1, "y": [1, 2, 4, 5, 6, 7], "xx": 1, "yy": 1, "mgrid": [1, 2, 4, 5], "vstack": 1, "ravel": [1, 4, 6], "valu": [1, 6, 7], "kernel": [1, 4, 5, 6, 7], "reshap": [1, 2, 4, 6], "t": [1, 2, 4, 5, 6], "cfset": 1, "contourf": [1, 4, 5], "cmap": [1, 4, 6], "blue": [1, 2, 5], "imshow": [1, 6], "rot90": 1, "extent": 1, "cset": 1, "contour": [1, 2, 3], "color": [1, 2, 4, 5], "k": [1, 6], "rcparam": [1, 2, 5], "titlepad": 1, "mixtur": 1, "decread": 1, "50k": 1, "num_training_step": 1, "50000": 1, "schedule_fn": 1, "lambda": [1, 2, 7], "05": [1, 7], "55": [1, 7], "i": [1, 2, 4, 5, 6, 7], "grad": 1, "uniform": 1, "sgld_sampl": 1, "ha": [1, 4, 6, 7], "time": [1, 2, 4, 6], "start": [1, 2, 7], "poor": [1, 4], "lw": 1, "alpha": [1, 2, 5], "set_ylim": [1, 6], "axi": [1, 2, 4, 5, 6, 7], "off": [1, 6], "better": [1, 4, 6, 7], "slgd": 1, "altern": [1, 2], "between": [1, 3, 6, 7], "phase": [1, 2], "descent": 1, "ish": 1, "size": [1, 2, 4, 6, 7], "both": [1, 7], "govern": 1, "built": [1, 3], "type": 1, "namedtupl": 1, "class": [1, 4, 6], "schedulest": 1, "step_siz": [1, 6], "float": 1, "do_sampl": 1, "bool": 1, "build_schedul": 1, "num_cycl": 1, "initial_step_s": 1, "exploration_ratio": 1, "cycle_length": 1, "step_id": 1, "cos_out": 1, "co": [1, 4], "pi": 1, "visual": 1, "200k": 1, "train": [1, 6], "divid": 1, "cycl": 1, "At": 1, "4th": [1, 7], "dedic": 1, "pyplot": [1, 2, 4, 5], "20000": 1, "sampling_point": 1, "ma": 1, "masked_wher": 1, "ls": 1, "r": [1, 2, 4, 5], "stage": 1, "fontsiz": 1, "now": [1, 2, 4, 5, 6, 7], "act": 1, "drop": [1, 6], "replac": 1, "optax": 1, "pytre": 1, "optstat": 1, "cyclicalsgmcmcst": 1, "opt_stat": 1, "cyclical_sgld": 1, "grad_estimator_fn": 1, "sgd": 1, "init_fn": 1, "step_fn": 1, "schedule_st": 1, "step_with_sgld": 1, "current_st": 1, "new_posit": 1, "step_with_sgd": 1, "rescaled_grad": 1, "updat": [1, 6], "new_opt_st": 1, "apply_upd": 1, "new_stat": 1, "cond": 1, "leav": [1, 4, 6], "sghmc": 1, "exercis": [1, 6], "reader": 1, "If": [1, 4, 6], "you": [1, 2, 6], "want": 1, "your": [1, 6], "model": [1, 6], "simpli": [1, 6], "copi": 1, "past": 1, "code": [1, 4, 6], "cell": 1, "builder": 1, "number": [1, 2, 6, 7], "ll": 1, "30": [1, 7], "75": [1, 7], "m": [1, 2, 4, 5, 7], "09": [1, 7], "ratio": 1, "init_st": [1, 7], "cyclical_sampl": 1, "37": [1, 7], "By": 1, "seem": 1, "And": [1, 2, 5, 6], "inde": [1, 7], "assum": [1, 4], "total": [1, 2, 4], "provid": [1, 3, 5], "thu": [1, 7], "fit": [1, 7], "raw": 1, "should": [1, 7], "pass": 1, "bandwidth": 1, "manual": 1, "n_": [1, 4, 6], "eff": 1, "captur": [1, 4], "ruqi": 1, "zhang": 1, "chunyuan": 1, "li": 1, "jianyi": 1, "changyou": 1, "chen": 1, "andrew": 1, "gordon": 1, "wilson": 1, "intern": [1, 2, 7], "confer": [1, 7], "represent": 1, "2019": 1, "introduc": 2, "patch": 2, "ellips": 2, "sklearn": [2, 4, 5], "make_biclust": [2, 5], "cluster": [2, 5], "scikit": [2, 5], "function": [2, 5, 6, 7], "num_point": [2, 5], "row": [2, 5, 7], "col": [2, 5], "nois": [2, 4, 5], "random_st": [2, 5], "314": [2, 5], "minval": [2, 5], "maxval": [2, 5], "whether": [2, 5, 6], "belong": [2, 5], "tab": [2, 5], "red": [2, 5], "el": [2, 5], "els": [2, 4, 5], "scatter": [2, 4, 5], "edgecolor": [2, 5], "c": [2, 4, 5, 7], "xlabel": [2, 4, 5, 6], "x_0": [2, 5], "ylabel": [2, 4, 5, 6], "x_1": [2, 5], "logist": [2, 3], "regress": [2, 3], "note": [2, 5, 6], "binari": [2, 4, 5, 7], "variabl": [2, 5, 7], "indic": [2, 5], "sim": [2, 4, 5, 6, 7], "operatornam": [2, 5, 6, 7], "comm": [2, 5], "phi": [2, 4, 5], "boldsymbol": [2, 5, 6, 7], "w": [2, 4, 5], "vector": [2, 5, 6], "whose": [2, 5], "prior": [2, 4, 5, 6, 7], "center": [2, 4, 5, 7], "matrix": [2, 4, 5, 7], "contain": [2, 5], "phi_": [2, 5], "n": [2, 4, 5], "sigmoid": [2, 5, 7], "z": [2, 4, 5], "exp": [2, 5, 6], "log_sigmoid": [2, 5], "log_an": [2, 5], "log_likelihood_term": [2, 5], "prior_term": [2, 5], "sum": [2, 4, 5, 6, 7], "locat": 2, "along": 2, "optim": 2, "path": 2, "covari": 2, "invers": 2, "hessian": 2, "produc": 2, "draw": 2, "lowest": 2, "kullback": 2, "leibler": 2, "kl": 2, "diverg": [2, 7], "memori": [2, 6], "bfg": 2, "understand": [2, 3], "evalu": [2, 4, 6], "dure": 2, "its": [2, 4, 6, 7], "run": [2, 4, 5, 6, 7], "here": [2, 4, 6, 7], "l": [2, 4], "deriv": 2, "elbo": 2, "w0": [2, 5], "zero": [2, 5], "vi": 2, "ftol": 2, "ellipse_confid": 2, "cov": 2, "n_std": 2, "lambda_": 2, "v": 2, "linalg": 2, "eig": 2, "sqrt": [2, 4], "xy": 2, "width": 2, "height": 2, "angl": 2, "degre": 2, "arctan2": 2, "facecolor": 2, "b": 2, "add_artist": 2, "x_": [2, 6], "y_": [2, 6], "pos_": 2, "dstack": 2, "logp_": 2, "nan_to_num": 2, "1e10": 2, "levels_": 2, "percentil": 2, "linspac": [2, 6, 7], "60": [2, 7], "isfinit": 2, "int": [2, 4, 6], "ceil": 2, "sharex": [2, 4], "sharei": [2, 4], "zip": [2, 4], "tree_map": [2, 7], "sample_st": 2, "position_path": 2, "marker": 2, "linestyl": 2, "markers": 2, "mu_i": 2, "cov_i": 2, "mean": [2, 4, 5, 6, 7], "rowvar": 2, "set_titl": [2, 5], "nestim": 2, "api": 2, "5_000": [2, 5], "displai": [2, 5], "trace": [2, 5], "enumer": [2, 4, 5], "w_": [2, 5], "pleas": 2, "find": 2, "best": 2, "just": 2, "multinorm": 2, "have": [2, 4, 5, 7], "been": 2, "alreadi": 2, "henc": 2, "sens": 2, "sample_from_st": 2, "helper": 2, "loop": [2, 5, 7], "user": [2, 3, 4], "sy": [2, 4], "40": [2, 7], "ms": [2, 7], "44": [2, 4, 7], "wall": [2, 4], "42": [2, 7], "quick": 2, "comparison": [2, 3], "against": 2, "rmh": [2, 5], "inference_loop": [2, 4, 5, 7], "initial_st": [2, 4, 5], "one_step": [2, 4, 5], "kei": [2, 4, 5, 6, 7], "scan": [2, 4, 5, 7], "ones": [2, 4, 5, 6, 7], "7": [2, 5, 6, 7], "state_rmh": 2, "samples_rmh": 2, "axvlin": [2, 5], "300": [2, 5], "calcul": 2, "explicitli": 2, "lbfgs_inverse_hessian_formula_1": 2, "lbfg": 2, "inverse_mass_matrix": 2, "beta": [2, 7], "22071722": 2, "05641346": 2, "05641348": 2, "23935081": 2, "dtype": [2, 6, 7], "float32": [2, 6], "coupl": 2, "nesterov": 2, "dual": 2, "averag": [2, 4, 5, 6], "adapt": [2, 4, 7], "yield": [2, 6], "scheme": 2, "pathfinder_adapt": 2, "nut": [2, 4], "struggl": 2, "likelihood": [2, 6, 7], "suggest": 2, "doubl": 2, "precis": [2, 4], "order": 2, "do": [2, 4, 6, 7], "configur": 2, "up": [2, 4], "otherwis": [2, 6], "stick": 2, "try": 2, "tweak": 2, "gtol": 2, "mai": [2, 6], "bad": [2, 6, 7], "longer": 2, "datapoint": 2, "seri": 3, "tutori": 3, "librari": [3, 6], "aim": 3, "beginn": 3, "mechan": 3, "behind": 3, "commonli": 3, "advanc": 3, "sgld": [3, 6], "langevin": 3, "dynam": 3, "pathfind": 3, "mlp": 3, "classifi": [3, 7], "hierarch": [3, 7], "spars": 3, "blog": 4, "post": 4, "thoma": 4, "wiecki": 4, "origin": 4, "pymc3": 4, "convert": 4, "aleyna": 4, "kara": 4, "karalleyna": 4, "kevin": 4, "murphi": 4, "murphyk": 4, "numpyro": [4, 7], "moon": 4, "rotat": 4, "amount": 4, "These": 4, "correspond": [4, 6, 7], "nonlinear": 4, "classif": [4, 6], "few": [4, 6, 7], "layer": 4, "perceptron": 4, "pool": 4, "all": [4, 6, 7], "singl": 4, "becaus": 4, "mix": 4, "togeth": 4, "decis": [4, 6], "boundari": 4, "But": [4, 6], "below": 4, "theta_t": 4, "could": 4, "cours": 4, "imbalanc": 4, "scenario": 4, "functool": 4, "partial": 4, "filterwarn": 4, "flax": [4, 6], "linen": [4, 6], "nn": [4, 6], "seaborn": 4, "sn": 4, "tensorflow_prob": 4, "substrat": 4, "tfd": 4, "make_moon": 4, "preprocess": 4, "ignor": [4, 6], "set_styl": 4, "white": 4, "diverging_palett": 4, "250": 4, "85": [4, 7], "as_cmap": 4, "cmap_uncertainti": 4, "cubehelix_palett": 4, "light": 4, "n_sampl": 4, "despin": 4, "n_group": 4, "n_grps_sq": 4, "deg": 4, "theta": [4, 6], "radian": 4, "sin": 4, "dot": 4, "asarrai": 4, "seed": 4, "31": [4, 7], "xs": 4, "ys": 4, "linearli": 4, "randomli": 4, "categori": [4, 6], "rotate_bi": 4, "randn": 4, "90": [4, 6, 7], "stack": [4, 6], "xs_train": 4, "xs_test": 4, "ys_train": 4, "ys_test": 4, "nrow": 4, "ncol": 4, "x1": 4, "x2": 4, "grid": 4, "100j": 4, "grid_3d": 4, "repeat": 4, "get_predict": 4, "appli": [4, 6, 7], "in_ax": [4, 6, 7], "out_ax": 4, "predict": [4, 6], "logit": 4, "get_mean_predict": 4, "threshold": [4, 6], "comput": [4, 5, 6, 7], "confid": 4, "interv": 4, "around": [4, 7], "median": [4, 7], "mean_predict": 4, "fit_and_ev": 4, "x_train": [4, 6], "y_train": [4, 6], "x_test": [4, 6], "init_kei": 4, "warmup_kei": 4, "inference_kei": 4, "train_kei": 4, "test_kei": 4, "grid_kei": 4, "initial_posit": 4, "logprob": 4, "warm": 4, "window_adapt": 4, "final_st": 4, "param": [4, 6], "num_warmup": [4, 6, 7], "infer": [4, 5, 7], "y_pred_train": 4, "y_pred_test": 4, "pred_grid": 4, "hidden": 4, "unit": 4, "hidden_layer_width": 4, "n_hidden_lay": 4, "500": [4, 6], "t_": 4, "ijl": 4, "node": 4, "j": 4, "modul": [4, 6], "layer_width": 4, "compact": [4, 6], "__call__": [4, 6], "self": [4, 6], "dens": [4, 6], "featur": [4, 6], "tanh": 4, "bnn": 4, "tree_util": [4, 6, 7], "tree_flatten": [4, 6], "flat_param": [4, 6], "log_prob": 4, "logdensity_fn_of_bnn": 4, "fit_and_eval_single_mlp": 4, "ys_pred_train": 4, "ys_pred_test": 4, "ppc_grid_singl": 4, "accuraci": [4, 6], "reason": 4, "underli": 4, "pattern": 4, "bay": 4, "linear": 4, "prevent": 4, "overfit": 4, "print": [4, 6, 7], "86": [4, 7], "89": [4, 7], "81": [4, 7], "plot_decision_surfaces_non_hierarch": 4, "y_pred": 4, "y_true": 4, "sinc": [4, 5], "common": 4, "own": 4, "specif": 4, "mu_": 4, "sigma_l": 4, "form": 4, "epsilon": 4, "d": [4, 6, 7], "input": 4, "l_1": 4, "l_2": 4, "scalar": 4, "output": 4, "repres": [4, 6], "noncentereddens": 4, "ep": 4, "std": [4, 7], "hnn": 4, "logprior_fn_of_hnn": 4, "lp": 4, "half_norm": 4, "halfnorm": 4, "lparam": 4, "noncentereddense_": 4, "dense_0": 4, "logdensity_fn_of_hnn": 4, "ys_hierarchical_pred_train": 4, "ys_hierarchical_pred_test": 4, "ppc_grid": 4, "1min": 4, "36": [4, 7], "96": [4, 7], "39": [4, 7], "38": [4, 6, 7], "share": 4, "desir": 4, "format": 4, "91": [4, 7], "87": [4, 7], "plot_decision_surfaces_hierarch": 4, "walk": 5, "rosenbluth": 5, "metropoli": 5, "hast": 5, "c_": 5, "doe": 5, "ourselv": [5, 7], "burnin": 5, "nsamp": 5, "coeffici": [5, 7], "meshgrid": 5, "xspace": 5, "nx": 5, "ny": 5, "phispac": 5, "z_mcmc": 5, "einsum": 5, "mij": 5, "sm": 5, "sij": 5, "mnist": 6, "digit": 6, "download": 6, "huggingfac": 6, "load_dataset": 6, "mnist_data": 6, "data_train": 6, "data_test": 6, "test": 6, "imag": 6, "y_test": 6, "home": 6, "runner": 6, "cach": 6, "fda16c03c4ecfb13f165ba7e29cf38129ce035011519968cdaf74894ce91c9d4": 6, "subsequ": 6, "call": 6, "reus": 6, "sever": 6, "transform": [6, 7], "come": 6, "28x28": 6, "pixel": 6, "matric": 6, "rgb": 6, "255": 6, "maximum": 6, "hot": 6, "encod": [6, 7], "one_hot_encod": 6, "prepare_data": 6, "num_categori": 6, "num_exampl": 6, "num_pixel": 6, "28": [6, 7], "batch_data": 6, "batch": 6, "while": [6, 7], "idx": 6, "tupl": 6, "elem": 6, "n_train": 6, "n_test": 6, "veri": 6, "A": [6, 7], "y_i": 6, "written": 6, "begin": [6, 7], "align": [6, 7], "categor": [6, 7], "end": [6, 7], "relu": 6, "log_softmax": 6, "compute_accuraci": 6, "highest": 6, "loss": 6, "target_class": 6, "argmax": 6, "predicted_class": 6, "discard": 6, "until": 6, "reach": 6, "2000": [6, 7], "record": 6, "current": 6, "everi": [6, 7], "len": [6, 7], "512": 6, "5e": 6, "constant": 6, "next": 6, "error": 6, "1f": 6, "2340": 6, "wise": 6, "process": 6, "pointwis": 6, "like": 6, "still": [6, 7], "increas": 6, "plateau": 6, "accumul": 6, "would": [6, 7], "requir": 6, "subtanti": 6, "amounf": 6, "quantiti": 6, "interest": [6, 7], "formal": 6, "theta_i": 6, "mid": 6, "mont": [6, 7], "carlo": [6, 7], "mathcal": 6, "mathrm": 6, "approx": 6, "frac": 6, "sum_": 6, "theta_": 6, "update_test_accuraci": 6, "logpredictprob": 6, "new_logpredictprob": 6, "logaddexp": 6, "predict_prob": 6, "sgld_accuraci": 6, "sgld_logpredict": 6, "avg": 6, "57": [6, 7], "clear": 6, "last": [6, 7], "last_accuraci": 6, "96389997": 6, "95519996": 6, "008700013": 6, "decreas": 6, "decent": 6, "wa": [6, 7], "fine": 6, "took": 6, "led": 6, "num_integration_step": 6, "sghmc_accuraci": 6, "04": [6, 7], "21": [6, 7], "sghmc_logpredict": 6, "56": [6, 7], "evolut": 6, "give": 6, "slightli": 6, "than": 6, "term": 6, "mislead": 6, "onc": 6, "overconfid": 6, "sai": 6, "unsur": 6, "given": 6, "less": 6, "tham": 6, "max_predict_prob": 6, "certain_mask": 6, "our": 6, "certain": 6, "92": [6, 7], "uncertain": 6, "most_uncertain_idx": 6, "argsort": 6, "grai": 6, "lax_numpi": 6, "3539": 6, "userwarn": 6, "kind": [6, 7], "argument": 6, "stabl": 6, "sort": 6, "support": 6, "about": 6, "uncertain_mask": 6, "bar": 6, "bincount": 6, "set_xtick": 6, "perhap": 6, "unsurprisingli": 6, "overrepres": 6, "max_d": 6, "x_i": 6, "pure": 6, "academ": 6, "saniti": 6, "re": 6, "vari": 6, "prob": 6, "dropped_ratio": 6, "121": 6, "122": 6, "tight_layout": [6, 7], "Not": 6, "99": [6, 7], "Such": 6, "reject": 6, "criterion": 6, "realist": 6, "practic": 6, "what": 6, "design": 6, "describ": 6, "cost": 6, "mistak": 6, "choos": [6, 7], "fact": 6, "hierarchi": 7, "proxi": 7, "select": 7, "horsesho": 7, "cps10": 7, "ensur": 7, "sparsiti": 7, "consist": 7, "put": 7, "global": 7, "tau": 7, "concentr": 7, "degener": 7, "exclud": 7, "funnel": 7, "geometri": 7, "effici": 7, "prskold07": 7, "mathemat": 7, "parametr": 7, "numer": 7, "defin": 7, "aesara": 7, "tensor": 7, "x_at": 7, "srng": 7, "randomstream": 7, "tau_rv": 7, "halfcauchi": 7, "lambda_rv": 7, "beta_rv": 7, "eta": 7, "y_rv": 7, "name": 7, "necessarili": 7, "One": 7, "alwai": 7, "check": 7, "posteriori": 7, "did": 7, "encount": 7, "geomtri": 7, "dg17": 7, "handl": 7, "panda": 7, "pd": 7, "read_tabl": 7, "http": 7, "archiv": 7, "ic": 7, "uci": 7, "edu": 7, "ml": 7, "machin": 7, "databas": 7, "statlog": 7, "header": 7, "delim_whitespac": 7, "custom": 7, "depend": 7, "equal": 7, "good": 7, "iloc": 7, "r_bad": 7, "r_good": 7, "regressor": 7, "add": 7, "column": 7, "intercept": 7, "logdens": 7, "aeppl": 7, "oper": 7, "real": 7, "line": 7, "transformvaluesrewrit": 7, "logtransform": 7, "transforms_op": 7, "value_vari": 7, "joint_logprob": 7, "realiz": 7, "as_tensor": 7, "extra_rewrit": 7, "logdensity_aesara_fn": 7, "log_tau": 7, "log_lmbda": 7, "vm": 7, "jit_fn": 7, "util": 7, "n_iter": 7, "hs22": 7, "combin": 7, "hmc": 7, "procedur": 7, "num_chain": 7, "128": 7, "key_b": 7, "key_l": 7, "key_t": 7, "heurist": 7, "hamiltonian": 7, "key_warmup": 7, "key_sampl": 7, "meads_adapt": 7, "ghmc": 7, "summari": 7, "statist": 7, "includ": 7, "rhat": 7, "diagnost": 7, "print_summari": 7, "n_eff": 7, "r_hat": 7, "26": 7, "33": 7, "74": 7, "22": 7, "45": 7, "94": 7, "06": 7, "80": 7, "02": 7, "64": 7, "73": 7, "01": 7, "71": 7, "17": 7, "76": 7, "62": 7, "41": 7, "13": 7, "63": 7, "14": 7, "61": 7, "47": 7, "54": 7, "08": 7, "83": 7, "69": 7, "27": 7, "11": 7, "29": 7, "46": 7, "53": 7, "59": 7, "52": 7, "07": 7, "84": 7, "58": 7, "68": 7, "77": 7, "24": 7, "32": 7, "34": 7, "72": 7, "116": 7, "93": 7, "97": 7, "88": 7, "66": 7, "43": 7, "82": 7, "79": 7, "65": 7, "70": 7, "48": 7, "51": 7, "transit": 7, "is_diverg": 7, "int64": 7, "earlier": 7, "solut": 7, "present": 7, "although": 7, "worth": 7, "interact": 7, "sure": 7, "wai": 7, "gs": 7, "o": 7, "rf": 7, "some": 7, "instanc": 7, "15th": 7, "exhibit": 7, "particular": 7, "correl": 7, "observ": 7, "13th": 7, "etc": 7, "ideal": 7, "adopt": 7, "those": 7, "assess": 7, "abil": 7, "convinc": 7, "induc": 7, "bin": 7, "get_yaxi": 7, "mani": 7, "notic": 7, "carvalho": 7, "nichola": 7, "polson": 7, "jame": 7, "scott": 7, "signal": 7, "biometrika": 7, "465": 7, "480": 7, "2010": 7, "dheeru": 7, "dua": 7, "casei": 7, "graff": 7, "repositori": 7, "2017": 7, "url": 7, "matthew": 7, "hoffman": 7, "pavel": 7, "sountsov": 7, "free": 7, "artifici": 7, "intellig": 7, "7799": 7, "7813": 7, "pmlr": 7, "2022": 7, "omiro": 7, "papaspiliopoulo": 7, "gareth": 7, "robert": 7, "martin": 7, "sk": 7, "\u00f6": 7, "ld": 7, "scienc": 7, "page": 7, "2007": 7}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"contour": 0, "stochast": 0, "gradient": 0, "langevin": 0, "dynam": 0, "gaussian": 0, "mixtur": 0, "model": [0, 2, 3, 4, 5, 7], "sampl": [0, 3, 5, 6], "sgld": [0, 1], "how": 0, "doe": 0, "work": 0, "cyclic": 1, "schedul": 1, "step": 1, "function": [1, 4], "pathfind": 2, "The": [2, 3, 5], "data": [2, 4, 5, 6], "parallel": 2, "quasi": 2, "newton": 2, "variat": 2, "infer": 2, "method": 2, "an": 2, "initi": 2, "tool": 2, "mcmc": 2, "kernel": 2, "some": 2, "caveat": 2, "book": 3, "project": 3, "algorithm": 3, "hierarch": 4, "bayesian": [4, 5], "neural": 4, "network": 4, "setup": 4, "util": 4, "train": 4, "test": 4, "hyperparamet": 4, "fit": 4, "separ": 4, "mlp": [4, 6], "One": 4, "per": 4, "task": 4, "result": 4, "logist": 5, "regress": [5, 7], "posterior": [5, 6], "predict": 5, "distribut": [5, 6], "classifi": 6, "prepar": 6, "multi": 6, "layer": 6, "perceptron": 6, "from": 6, "s": 6, "weight": 6, "sghmc": 6, "comparison": 6, "explor": 6, "uncertainti": 6, "spars": 7, "german": 7, "credit": 7, "dataset": 7, "mead": 7, "bibliographi": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 56}})